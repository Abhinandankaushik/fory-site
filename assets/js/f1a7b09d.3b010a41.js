"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[8742],{42460:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var s=r(85893),i=r(11151);const t={title:"Generated Code",sidebar_position:5,id:"generated_code",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},a=void 0,o={id:"compiler/generated_code",title:"Generated Code",description:"This document explains generated code for each target language.",source:"@site/docs/compiler/generated-code.md",sourceDirName:"compiler",slug:"/compiler/generated_code",permalink:"/docs/next/compiler/generated_code",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/compiler/generated-code.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Generated Code",sidebar_position:5,id:"generated_code",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Compiler Guide",permalink:"/docs/next/compiler/compiler_guide"},next:{title:"FlatBuffers IDL Support",permalink:"/docs/next/compiler/flatbuffers_idl"}},d={},l=[{value:"Example Fory IDL Schema",id:"example-fory-idl-schema",level:2},{value:"Java",id:"java",level:2},{value:"Output Layout",id:"output-layout",level:3},{value:"Type Generation",id:"type-generation",level:3},{value:"Registration",id:"registration",level:3},{value:"Usage",id:"usage",level:3},{value:"Python",id:"python",level:2},{value:"Output Layout",id:"output-layout-1",level:3},{value:"Type Generation",id:"type-generation-1",level:3},{value:"Registration",id:"registration-1",level:3},{value:"Usage",id:"usage-1",level:3},{value:"Rust",id:"rust",level:2},{value:"Output Layout",id:"output-layout-2",level:3},{value:"Type Generation",id:"type-generation-2",level:3},{value:"Registration",id:"registration-2",level:3},{value:"Usage",id:"usage-2",level:3},{value:"C++",id:"c",level:2},{value:"Output Layout",id:"output-layout-3",level:3},{value:"Type Generation",id:"type-generation-3",level:3},{value:"Registration",id:"registration-3",level:3},{value:"Usage",id:"usage-3",level:3},{value:"Go",id:"go",level:2},{value:"Output Layout",id:"output-layout-4",level:3},{value:"Type Generation",id:"type-generation-4",level:3},{value:"Registration",id:"registration-4",level:3},{value:"Usage",id:"usage-4",level:3},{value:"Cross-Language Notes",id:"cross-language-notes",level:2},{value:"Type ID Behavior",id:"type-id-behavior",level:3},{value:"Nested Type Shapes",id:"nested-type-shapes",level:3}];function c(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"This document explains generated code for each target language."}),"\n",(0,s.jsxs)(n.p,{children:["Fory IDL generated types are idiomatic in host languages and can be used directly as domain objects. Generated types also include ",(0,s.jsx)(n.code,{children:"to/from bytes"})," helpers and registration helpers."]}),"\n",(0,s.jsx)(n.p,{children:"All snippets are representative excerpts from real generated output."}),"\n",(0,s.jsx)(n.h2,{id:"example-fory-idl-schema",children:"Example Fory IDL Schema"}),"\n",(0,s.jsx)(n.p,{children:"The sections below use this schema:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:"package demo;\n\nenum DeviceTier [id=100] {\n    DEVICE_TIER_UNKNOWN = 0;\n    DEVICE_TIER_TIER1 = 1;\n    DEVICE_TIER_TIER2 = 2;\n}\n\nmessage User [id=101] {\n    string id = 1;\n    string name = 2;\n    optional string email = 3;\n}\n\nmessage SearchResponse [id=102] {\n    message Result [id=103] {\n        string url = 1;\n        string title = 2;\n    }\n    list<Result> results = 1;\n}\n\nmessage Dog [id=104] {\n    string name = 1;\n}\n\nmessage Cat [id=105] {\n    string name = 1;\n}\n\nunion Animal [id=106] {\n    Dog dog = 1;\n    Cat cat = 2;\n}\n\nmessage Order [id=107] {\n    string id = 1;\n    ref User customer = 2;\n    list<string> items = 3;\n    map<string, int32> quantities = 4;\n    DeviceTier tier = 5;\n    Animal pet = 6;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"java",children:"Java"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["For package ",(0,s.jsx)(n.code,{children:"demo"}),", Java code is generated under ",(0,s.jsx)(n.code,{children:"demo/"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DeviceTier.java"}),", ",(0,s.jsx)(n.code,{children:"User.java"}),", ",(0,s.jsx)(n.code,{children:"SearchResponse.java"}),", ",(0,s.jsx)(n.code,{children:"Dog.java"}),", ",(0,s.jsx)(n.code,{children:"Cat.java"}),", ",(0,s.jsx)(n.code,{children:"Animal.java"}),", ",(0,s.jsx)(n.code,{children:"Order.java"})]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DemoForyRegistration.java"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation",children:"Type Generation"}),"\n",(0,s.jsx)(n.p,{children:"Enum prefix stripping keeps scoped enum values clean:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public enum DeviceTier {\n    UNKNOWN,\n    TIER1,\n    TIER2;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Messages are regular Java classes with ",(0,s.jsx)(n.code,{children:"@ForyField"})," metadata and Java-style getters/setters:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class Order {\n    @ForyField(id = 1)\n    private String id;\n\n    @ForyField(id = 2, nullable = true, ref = true)\n    private User customer;\n\n    @ForyField(id = 3)\n    private List<String> items;\n\n    @ForyField(id = 4)\n    private Map<String, Integer> quantities;\n\n    @ForyField(id = 5)\n    private DeviceTier tier;\n\n    @ForyField(id = 6)\n    private Animal pet;\n\n    public String getId() { ... }\n    public void setId(String id) { ... }\n    public User getCustomer() { ... }\n    public void setCustomer(User customer) { ... }\n\n    public byte[] toBytes() { ... }\n    public static Order fromBytes(byte[] bytes) { ... }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Nested messages become static inner classes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class SearchResponse {\n    public static class Result { ... }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Unions generate explicit case APIs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"Animal pet = Animal.ofDog(new Dog());\nif (pet.hasDog()) {\n    Dog dog = pet.getDog();\n}\nAnimal.AnimalCase c = pet.getAnimalCase();\nint caseId = pet.getAnimalCaseId();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registration",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration helper:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class DemoForyRegistration {\n    public static void register(Fory fory) {\n        org.apache.fory.resolver.TypeResolver resolver = fory.getTypeResolver();\n        resolver.register(DeviceTier.class, 100L);\n        resolver.registerUnion(\n            Animal.class,\n            106L,\n            new org.apache.fory.serializer.UnionSerializer(fory, Animal.class));\n        resolver.register(User.class, 101L);\n        resolver.register(SearchResponse.class, 102L);\n        resolver.register(SearchResponse.Result.class, 103L);\n        resolver.register(Dog.class, 104L);\n        resolver.register(Cat.class, 105L);\n        resolver.register(Order.class, 107L);\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you disable auto IDs (",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"}),"), registration switches to namespace + type name:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'resolver.register(Config.class, "myapp.models", "Config");\nresolver.registerUnion(\n    Holder.class,\n    "myapp.models",\n    "Holder",\n    new org.apache.fory.serializer.UnionSerializer(fory, Holder.class));\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'Order order = new Order();\norder.setId("o456");\norder.setCustomer(new User());\norder.setTier(DeviceTier.TIER1);\norder.setPet(Animal.ofDog(new Dog()));\n\nbyte[] bytes = order.toBytes();\nOrder restored = Order.fromBytes(bytes);\n'})}),"\n",(0,s.jsx)(n.h2,{id:"python",children:"Python"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-1",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["One module is generated per package, for example ",(0,s.jsx)(n.code,{children:"demo.py"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-1",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Enums are ",(0,s.jsx)(n.code,{children:"IntEnum"})," values with prefix stripping:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class DeviceTier(IntEnum):\n    UNKNOWN = 0\n    TIER1 = 1\n    TIER2 = 2\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Messages are ",(0,s.jsx)(n.code,{children:"@pyfory.dataclass"})," classes:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'@pyfory.dataclass(repr=False)\nclass Order:\n    id: str = pyfory.field(id=1, default="")\n    customer: Optional[User] = pyfory.field(id=2, nullable=True, ref=True, default=None)\n    items: List[str] = pyfory.field(id=3, default_factory=list)\n    quantities: Dict[str, pyfory.int32] = pyfory.field(id=4, default_factory=dict)\n    tier: DeviceTier = pyfory.field(id=5, default=None)\n    pet: Animal = pyfory.field(id=6, default=None)\n\n    def to_bytes(self) -> bytes: ...\n    @classmethod\n    def from_bytes(cls, data: bytes) -> "Order": ...\n'})}),"\n",(0,s.jsx)(n.p,{children:"Nested messages stay nested:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'@pyfory.dataclass\nclass SearchResponse:\n    @pyfory.dataclass\n    class Result:\n        url: str = pyfory.field(id=1, default="")\n        title: str = pyfory.field(id=2, default="")\n'})}),"\n",(0,s.jsx)(n.p,{children:"Unions generate case enum + typed accessors:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'pet = Animal.dog(Dog(name="Rex"))\nif pet.is_dog():\n    dog = pet.dog_value()\ncase_id = pet.case_id()\n'})}),"\n",(0,s.jsx)(n.h3,{id:"registration-1",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"def register_demo_types(fory: pyfory.Fory):\n    fory.register_type(DeviceTier, type_id=100)\n    fory.register_union(Animal, type_id=106, serializer=AnimalSerializer(fory))\n    fory.register_type(User, type_id=101)\n    fory.register_type(SearchResponse, type_id=102)\n    fory.register_type(SearchResponse.Result, type_id=103)\n    fory.register_type(Dog, type_id=104)\n    fory.register_type(Cat, type_id=105)\n    fory.register_type(Order, type_id=107)\n"})}),"\n",(0,s.jsx)(n.p,{children:"If auto IDs are disabled:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'fory.register_type(Config, namespace="myapp.models", typename="Config")\nfory.register_union(\n    Holder,\n    namespace="myapp.models",\n    typename="Holder",\n    serializer=HolderSerializer(fory),\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-1",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'order = Order(\n    id="o456",\n    customer=User(id="u1", name="Alice"),\n    items=["a", "b"],\n    quantities={"a": 1, "b": 2},\n    tier=DeviceTier.TIER1,\n    pet=Animal.dog(Dog(name="Rex")),\n)\n\ndata = order.to_bytes()\nrestored = Order.from_bytes(data)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"rust",children:"Rust"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-2",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["One Rust module file per package, for example ",(0,s.jsx)(n.code,{children:"demo.rs"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-2",children:"Type Generation"}),"\n",(0,s.jsx)(n.p,{children:"Enums are strongly typed and use stripped, idiomatic variant names:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"#[derive(ForyObject, Debug, Clone, PartialEq, Default)]\n#[repr(i32)]\npub enum DeviceTier {\n    #[default]\n    Unknown = 0,\n    Tier1 = 1,\n    Tier2 = 2,\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Messages derive ",(0,s.jsx)(n.code,{children:"ForyObject"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:'#[derive(ForyObject, Clone, PartialEq, Default)]\npub struct Order {\n    #[fory(id = 1)]\n    pub id: String,\n    #[fory(id = 2, nullable = true, ref = true)]\n    pub customer: Option<Arc<User>>,\n    #[fory(id = 3)]\n    pub items: Vec<String>,\n    #[fory(id = 4)]\n    pub quantities: HashMap<String, i32>,\n    #[fory(id = 5)]\n    pub tier: DeviceTier,\n    #[fory(id = 6, type_id = "union")]\n    pub pet: Animal,\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Nested types are generated in nested modules:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub mod search_response {\n    #[derive(ForyObject, Debug, Clone, PartialEq, Default)]\n    pub struct Result { ... }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Unions map to Rust enums with per-case IDs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"#[derive(ForyObject, Debug, Clone, PartialEq)]\npub enum Animal {\n    #[fory(id = 1)]\n    Dog(Dog),\n    #[fory(id = 2)]\n    Cat(Cat),\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registration-2",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub fn register_types(fory: &mut Fory) -> Result<(), fory::Error> {\n    fory.register::<DeviceTier>(100)?;\n    fory.register_union::<Animal>(106)?;\n    fory.register::<User>(101)?;\n    fory.register::<search_response::Result>(103)?;\n    fory.register::<SearchResponse>(102)?;\n    fory.register::<Dog>(104)?;\n    fory.register::<Cat>(105)?;\n    fory.register::<Order>(107)?;\n    Ok(())\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"If auto IDs are disabled:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:'fory.register_by_namespace::<Config>("myapp.models", "Config")?;\nfory.register_union_by_namespace::<Holder>("myapp.models", "Holder")?;\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-2",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:'let order = Order {\n    id: "o456".into(),\n    customer: Some(Arc::new(User::default())),\n    items: vec!["a".into(), "b".into()],\n    quantities: HashMap::new(),\n    tier: DeviceTier::Tier1,\n    pet: Animal::Dog(Dog { name: "Rex".into() }),\n};\n\nlet bytes = order.to_bytes()?;\nlet restored = Order::from_bytes(&bytes)?;\n'})}),"\n",(0,s.jsx)(n.h2,{id:"c",children:"C++"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-3",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["One header per package, for example ",(0,s.jsx)(n.code,{children:"demo.h"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-3",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Enums are generated as ",(0,s.jsx)(n.code,{children:"enum class"})," with stripped names:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"enum class DeviceTier : int32_t {\n  UNKNOWN = 0,\n  TIER1 = 1,\n  TIER2 = 2,\n};\nFORY_ENUM(demo::DeviceTier, UNKNOWN, TIER1, TIER2);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Messages are generated as classes with typed accessors and private fields, including ",(0,s.jsx)(n.code,{children:"has_xxx"}),", ",(0,s.jsx)(n.code,{children:"mutable_xxx"}),", and ",(0,s.jsx)(n.code,{children:"set_xxx"})," where applicable:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"class Order final {\n public:\n  const std::string& id() const;\n  std::string* mutable_id();\n  template <class Arg, class... Args>\n  void set_id(Arg&& arg, Args&&... args);\n\n  bool has_customer() const;\n  const std::shared_ptr<User>& customer() const;\n  std::shared_ptr<User>* mutable_customer();\n  void set_customer(std::shared_ptr<User> value);\n  void clear_customer();\n\n  fory::Result<std::vector<uint8_t>, fory::Error> to_bytes() const;\n  static fory::Result<Order, fory::Error> from_bytes(\n      const std::vector<uint8_t>& data);\n\n private:\n  std::string id_;\n  std::shared_ptr<User> customer_;\n  std::vector<std::string> items_;\n  std::map<std::string, int32_t> quantities_;\n  DeviceTier tier_;\n  Animal pet_;\n\n public:\n  FORY_STRUCT(Order, id_, customer_, items_, quantities_, tier_, pet_);\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:"Nested messages are nested classes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"class SearchResponse final {\n public:\n  class Result final { ... };\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Unions are generated as tagged ",(0,s.jsx)(n.code,{children:"std::variant"})," wrappers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"Animal pet = Animal::dog(Dog{});\nif (pet.is_dog()) {\n  const Dog& dog = pet.dog();\n}\nuint32_t case_id = pet.animal_case_id();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registration-3",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"inline void register_types(fory::serialization::BaseFory& fory) {\n  fory.register_enum<DeviceTier>(100);\n  fory.register_union<Animal>(106);\n  fory.register_struct<User>(101);\n  fory.register_struct<SearchResponse::Result>(103);\n  fory.register_struct<SearchResponse>(102);\n  fory.register_struct<Dog>(104);\n  fory.register_struct<Cat>(105);\n  fory.register_struct<Order>(107);\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"If auto IDs are disabled:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'fory.register_struct<Config>("myapp.models", "Config");\nfory.register_union<Holder>("myapp.models", "Holder");\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-3",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'demo::Order order;\norder.set_id("o456");\norder.set_customer(std::make_shared<demo::User>());\n\nauto bytes_result = order.to_bytes();\nif (!bytes_result.ok()) {\n  return 1;\n}\nauto order_result = demo::Order::from_bytes(bytes_result.value());\nif (!order_result.ok()) {\n  return 1;\n}\ndemo::Order restored = std::move(order_result.value());\n'})}),"\n",(0,s.jsx)(n.h2,{id:"go",children:"Go"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-4",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["Go output path depends on whether ",(0,s.jsx)(n.code,{children:"go_package"})," is configured."]}),"\n",(0,s.jsxs)(n.p,{children:["When ",(0,s.jsx)(n.code,{children:"go_package"})," is set in schema options (as in ",(0,s.jsx)(n.code,{children:"integration_tests/idl_tests/idl/addressbook.fdl"}),"), output follows that package path, for example:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"integration_tests/idl_tests/go/addressbook/generated/addressbook.go"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Without ",(0,s.jsx)(n.code,{children:"go_package"}),", compiler derives output from the Fory IDL package name."]}),"\n",(0,s.jsxs)(n.p,{children:["For package ",(0,s.jsx)(n.code,{children:"demo"}),", output is:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"<go_out>/demo/demo.go"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For package ",(0,s.jsx)(n.code,{children:"myapp.models"}),", output is:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"<go_out>/models/myapp_models.go"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-4",children:"Type Generation"}),"\n",(0,s.jsx)(n.p,{children:"Enums keep Go-style unscoped constant names:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type DeviceTier int32\n\nconst (\n    DeviceTierUnknown DeviceTier = 0\n    DeviceTierTier1   DeviceTier = 1\n    DeviceTierTier2   DeviceTier = 2\n)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Messages are regular structs with fory tags:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'type User struct {\n    Id    string                    `fory:"id=1"`\n    Name  string                    `fory:"id=2"`\n    Email optional.Optional[string] `fory:"id=3,nullable"`\n}\n\ntype Order struct {\n    Id         string            `fory:"id=1"`\n    Customer   *User             `fory:"id=2,nullable,ref"`\n    Items      []string          `fory:"id=3"`\n    Quantities map[string]int32  `fory:"id=4"`\n    Tier       DeviceTier        `fory:"id=5"`\n    Pet        Animal            `fory:"id=6"`\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Nested type naming defaults to underscore:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type SearchResponse_Result struct { ... }\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can switch to concatenated names with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:'option go_nested_type_style = "camelcase";\n'})}),"\n",(0,s.jsx)(n.p,{children:"Unions generate typed case helpers:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'pet := DogAnimal(&Dog{Name: "Rex"})\nif dog, ok := pet.AsDog(); ok {\n    _ = dog\n}\n_ = pet.Visit(AnimalVisitor{\n    Dog: func(d *Dog) error { return nil },\n})\n'})}),"\n",(0,s.jsx)(n.h3,{id:"registration-4",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"func RegisterTypes(f *fory.Fory) error {\n    if err := f.RegisterEnum(DeviceTier(0), 100); err != nil {\n        return err\n    }\n    if err := f.RegisterUnion(Animal{}, 106, ...); err != nil {\n        return err\n    }\n    if err := f.RegisterStruct(User{}, 101); err != nil {\n        return err\n    }\n    // ... SearchResponse_Result, SearchResponse, Dog, Cat, Order\n    return nil\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"If auto IDs are disabled:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'if err := f.RegisterNamedStruct(Config{}, "myapp.models.Config"); err != nil { ... }\nif err := f.RegisterNamedUnion(Holder{}, "myapp.models.Holder", ...); err != nil { ... }\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-4",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'email := optional.Some("alice@example.com")\norder := &Order{\n    Id:       "o456",\n    Customer: &User{Id: "u1", Name: "Alice", Email: email},\n    Items:    []string{"a", "b"},\n    Tier:     DeviceTierTier1,\n    Pet:      DogAnimal(&Dog{Name: "Rex"}),\n}\n\ndata, err := order.ToBytes()\nif err != nil {\n    panic(err)\n}\nvar restored Order\nif err := restored.FromBytes(data); err != nil {\n    panic(err)\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"cross-language-notes",children:"Cross-Language Notes"}),"\n",(0,s.jsx)(n.h3,{id:"type-id-behavior",children:"Type ID Behavior"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Explicit ",(0,s.jsx)(n.code,{children:"[id=...]"})," is used directly."]}),"\n",(0,s.jsx)(n.li,{children:"Without explicit IDs, compiler-generated IDs are used by default."}),"\n",(0,s.jsxs)(n.li,{children:["With ",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"}),", generated code registers by namespace + type name."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"nested-type-shapes",children:"Nested Type Shapes"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Language"}),(0,s.jsx)(n.th,{children:"Nested Type Form"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Java"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Outer.Inner"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Python"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Outer.Inner"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Rust"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"outer::Inner"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"C++"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Outer::Inner"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Go"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"Outer_Inner"})," (default)"]})]})]})]})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},11151:(e,n,r)=>{r.d(n,{Z:()=>o,a:()=>a});var s=r(67294);const i={},t=s.createContext(i);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);